{% load static %}
{% load custom_tags %}
{% load i18n %}
<!doctype html>
<html lang="{{dil}}" data-layout="{{layout.data_layout}}" data-layout-style="{{layout_sitili.data_layout_style}}" data-layout-position="{{layout_pozisyonu.data_layout_position}}" data-topbar="{{topbar_color.data_topbar}}" data-sidebar="{{sidebar_rengi.data_sidebar}}" data-sidebar-size="{{sidebar_boyutu.data_sidebar_size}}" data-layout-width="{{layout_uzunlugu.data_layout_width}}" data-sidebar-visibility="{{side_bar_gorunum.data_sidebar_visibility}}" data-bs-theme="{{color_sheme.data_bs_theme}}" data-preloader="disable">
<head>
    <meta charset="utf-8" />
    <title>BiadaGO ERP Construciton Software{{site_adi.site_adi_sekme_tr}}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta content="{{site_adi.site_adi_genel}}" name="description" />
    <meta content="Biada Software" name="author" />
     <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="apple-touch-icon" sizes="57x57" href="{% static 'go/icon/apple-icon-57x57.png' %}">
    <link rel="apple-touch-icon" sizes="60x60" href="{% static 'go/icon/apple-icon-60x60.png' %}">
    <link rel="apple-touch-icon" sizes="72x72" href="{% static 'go/icon/apple-icon-72x72.png' %}">
    <link rel="apple-touch-icon" sizes="76x76" href="{% static 'go/icon/apple-icon-76x76.png' %}">
    <link rel="apple-touch-icon" sizes="114x114" href="{% static 'go/icon/apple-icon-114x114.png' %}">
    <link rel="apple-touch-icon" sizes="120x120" href="{% static 'go/icon/apple-icon-120x120.png' %}">
    <link rel="apple-touch-icon" sizes="144x144" href="{% static 'go/icon/apple-icon-144x144.png' %}">
    <link rel="apple-touch-icon" sizes="152x152" href="{% static 'go/icon/apple-icon-152x152.png' %}">
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'go/icon/apple-icon-180x180.png' %}">
    <link rel="icon" type="image/png" sizes="192x192"  href="{% static 'go/icon/android-icon-192x192.png' %}">
    <link rel="icon" type="image/png" sizes="32x32" href="{% static 'go/icon/favicon-32x32.png' %}">
    <link rel="icon" type="image/png" sizes="96x96" href="{% static 'go/icon/favicon-96x96.png' %}">
    <link rel="icon" type="image/png" sizes="16x16" href="{% static 'go/icon/favicon-16x16.png' %}">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="{% static 'go/icon/ms-icon-144x144.png' %}">
    <link rel="manifest" href="{% static 'manifest.json' %}">
    <meta name="theme-color" content="#22d6b6">
    <!-- Firebase App (modÃ¼ler SDK'lar iÃ§in temel kod) -->
<script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js"></script>

<!-- Firebase Messaging -->
<script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-messaging.js"></script>
    
<!--Start of Tawk.to Script-->
<script type="text/javascript">
var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
(function(){
var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
s1.async=true;
s1.src='https://embed.tawk.to/6820b54cb0c865190cac29cb/1iqvs8cnq';
s1.charset='UTF-8';
s1.setAttribute('crossorigin','*');
s0.parentNode.insertBefore(s1,s0);
})();
</script>
<script type="text/javascript">
    var Tawk_API = Tawk_API || {};
    Tawk_API.onLoad = function() {
        Tawk_API.setAttributes({
            'name'  : '{{request.user.last_name}}',
            'email' : '{{request.user.email}}',
        }, function(error){ console.log(error); });
    };
</script>

<!--End of Tawk.to Script-->
    
    <script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-analytics.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyD5HHO-gcwyuuWeXp1TzZKP8QTcPScwNZo",
    authDomain: "biadago-cloud.firebaseapp.com",
    projectId: "biadago-cloud",
    storageBucket: "biadago-cloud.firebasestorage.app",
    messagingSenderId: "990430074148",
    appId: "1:990430074148:web:83f5b40ec6944b8a268fb1",
    measurementId: "G-67DK949V4Q"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
</script>
    {% if dil == "ar" or dil == "ckb" %}
    <style>
      @font-face {
    font-family: 'MyCustomFont';
    src: url("{% static 'go/fonts/ckb.ttf' %}") format('truetype');
    font-weight: normal;
    font-style: normal;
}

body {
    font-family: 'MyCustomFont', sans-serif;
}
    </style>
<!-- soranice -->
{% else %}
<link href="https://fonts.googleapis.com/css2?family=Red+Hat+Display:ital,wght@0,300..900;1,300..900&display=swap"
        rel="stylesheet">
        <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
{% endif %}
    
    <link rel="stylesheet" href="{% static 'go/style/style.css' %}">
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://momentjs.com/downloads/moment.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="https://cdn.datatables.net/v/dt/dt-2.1.6/r-3.0.3/datatables.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.js"></script>
    


    {% block head %}

    {% endblock head %}

</head>
{% if dil == "ar" or dil == "ckb" %}
<body class="rtl">
{% else %}
<body>
{% endif %}
<!-- Ã‡evrimdÄ±ÅŸÄ± BarÄ± (altta gÃ¶sterilecek) -->
<div class="offline-bar" id="offline-bar" style="display: none; position: fixed; bottom: 0; left: 0; right: 0; background-color: #f44336; color: white; text-align: center; padding: 8px; z-index: 10000; margin-bottom: 0px;">
  {% trans 'BaÄŸlantÄ±nÄ±z kesildi. Ã‡evrimdÄ±ÅŸÄ± moddasÄ±nÄ±z!' %}
</div>

<!-- Ã‡evrimiÃ§i BarÄ± (altta gÃ¶sterilecek) -->
<div class="online-bar" id="online-bar" style="display: none; position: fixed; bottom: 0; left: 0; right: 0; background-color: #24d6b5; color: white; text-align: center; padding: 8px; z-index: 10000; margin-bottom: 0px;">
  {% trans 'BaÄŸlantÄ± geri geldi! SayfayÄ± yenileyebilirsiniz.' %}
</div>



{% block header %}

    {% include "page_include/header.html" %}

    <!-- END layout-wrapper -->
{% endblock header %}
{% block slider %}

{% endblock slider %}
{% block content %}

{% endblock content %}
{% block sidebar %}

{% endblock sidebar %}

{% block footer %}


{% endblock footer %}




{% block javascriptcode %}



{% endblock javascriptcode %}
{% block javascriptcodeadd %}

{% endblock javascriptcodeadd %}
<script>let hasGoneOffline = false;  // KullanÄ±cÄ±nÄ±n internetinin gidip gelmiÅŸ olup olmadÄ±ÄŸÄ±nÄ± kontrol eden deÄŸiÅŸken

function checkInternetConnection() {
  if (!navigator.onLine) {
    document.getElementById('offline-bar').style.display = 'block';
    document.getElementById('online-bar').style.display = 'none';
    hasGoneOffline = true;  // BaÄŸlantÄ± gitti
  } else {
    if (hasGoneOffline) {
      // Sadece internet daha Ã¶nce gittiyse Ã§evrimiÃ§i barÄ± gÃ¶ster
      document.getElementById('online-bar').style.display = 'block';
      setTimeout(function() {
        document.getElementById('online-bar').style.display = 'none';
      }, 3000);
      hasGoneOffline = false;  // BaÄŸlantÄ± geri geldiÄŸinde sÄ±fÄ±rla
    }
    document.getElementById('offline-bar').style.display = 'none';
  }
}

window.addEventListener('load', function() {
  checkInternetConnection();

  window.addEventListener('online', function() {
    checkInternetConnection();
  });

  window.addEventListener('offline', function() {
    checkInternetConnection();
  });
});

</script>
<script>
    document.getElementById('geriButonu').addEventListener('click', function() {
        window.history.back();  // Bir Ã¶nceki sayfaya gider
    });
    
</script>


<script>
// PWA Ä°Ã‡Ä°N EKLENDÄ° BAÅžLANGIÃ‡ - TOLGA
if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('serviceworker.js')
        .then(function(registration) {
            console.log('Service Worker registered with scope:', registration.scope);
        })
        .catch(function(error) {
            console.log('Service Worker registration failed:', error);
        });
}
</script>
<script>
document.getElementById("enable-notifications").addEventListener("click", () => {
  Notification.requestPermission().then(permission => {
    if (permission === 'granted') {
      console.log("Bildirim izni verildi.");
    } else {
      console.log("Bildirim izni reddedildi.");
    }
  }).catch(error => {
    console.error("Bildirim izni isteÄŸi baÅŸarÄ±sÄ±z:", error);
  });
});

</script>
<script>
document.getElementById('submitForm').addEventListener('click', function() {
    if ('serviceWorker' in navigator && 'SyncManager' in window) {
        navigator.serviceWorker.ready.then(function(registration) {
            return registration.sync.register('sendFormData');
        }).then(() => {
            console.log('Form data will be sent when back online');
        }).catch(error => {
            console.error('Background sync registration failed:', error);
        });
    } else {
        // EÄŸer desteklenmiyorsa doÄŸrudan form gÃ¶nderimi yapÄ±n
        sendFormDataOnline();
    }
});

// Ã‡evrimiÃ§iyken veriyi doÄŸrudan gÃ¶nder
function sendFormDataOnline() {
    const formData = {
        name: 'John Doe',
        email: 'johndoe@example.com'
    };

    fetch('/form-submit-endpoint', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(formData)
    })
    .then(response => {
        console.log('Form data sent successfully:', response);
    })
    .catch(error => {
        console.error('Error sending form data:', error);
    });
}

</script>
<script>
document.getElementById('submitForm').addEventListener('click', function() {
    const formData = {
        name: document.getElementById('name').value,
        email: document.getElementById('email').value
    };

    if (navigator.onLine) {
        // EÄŸer Ã§evrimiÃ§iyse doÄŸrudan gÃ¶nder
        sendFormDataOnline(formData);
    } else {
        // Ã‡evrimdÄ±ÅŸÄ±yken kaydet ve sync eventini baÅŸlat
        saveDataOffline(formData);

        if ('serviceWorker' in navigator && 'SyncManager' in window) {
            navigator.serviceWorker.ready.then(function(registration) {
                return registration.sync.register('sendOfflineData');
            });
        }
    }
});

function sendFormDataOnline(data) {
    fetch('/form-submit-endpoint', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
    })
    .then(response => console.log('Data sent online:', response))
    .catch(error => console.error('Failed to send data online:', error));
}
// PWA Ä°Ã‡Ä°N EKLENDÄ° SON - TOLGA

</script>
<script>
document.addEventListener('DOMContentLoaded', function () {
  const forms = document.querySelectorAll('form');
  
  forms.forEach(form => {
    form.addEventListener('submit', function (e) {
      const submitButtons = form.querySelectorAll('button[type="submit"], input[type="submit"]');
      
      submitButtons.forEach(btn => {
        btn.disabled = true;
        btn.innerText = 'GÃ¶nderiliyor...'; // Ä°steÄŸe gÃ¶re
      });
    });
  });
});
</script>
<script>
  // Emoji'leri silen fonksiyon
  function removeEmojis(str) {
    return str.replace(
      /([\u2700-\u27BF]|[\uE000-\uF8FF]|[\uD83C-\uDBFF][\uDC00-\uDFFF])/g,
      ''
    );
  }

  // Sayfadaki tÃ¼m input ve textarea'lara emoji filtresi uygula
  document.addEventListener('DOMContentLoaded', function () {
    document.querySelectorAll('input, textarea').forEach(element => {
      element.addEventListener('input', function () {
        const cleaned = removeEmojis(this.value);
        if (this.value !== cleaned) {
          this.value = cleaned;
        }
      });
    });
  });
</script>
<!-- Firebase compat SDK'larÄ± -->
<script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-messaging-compat.js"></script>

<script>
  // Firebase yapÄ±landÄ±rman
  const firebaseConfig = {
    apiKey: "AIzaSyD5HHO-gcwyuuWeXp1TzZKP8QTcPScwNZo",
    authDomain: "biadago-cloud.firebaseapp.com",
    projectId: "biadago-cloud",
    storageBucket: "biadago-cloud.appspot.com",
    messagingSenderId: "990430074148",
    appId: "1:990430074148:web:83f5b40ec6944b8a268fb1",
    measurementId: "G-67DK949V4Q"
  };

  // Firebase'i baÅŸlat
  const app = firebase.initializeApp(firebaseConfig);
  const messaging = firebase.messaging();

  // CSRF token alÄ±cÄ± fonksiyon (Django iÃ§in)
  function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
      const cookies = document.cookie.split(';');
      for (let i = 0; i < cookies.length; i++) {
        const cookie = cookies[i].trim();
        if (cookie.substring(0, name.length + 1) === (name + '=')) {
          cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
          break;
        }
      }
    }
    return cookieValue;
  }

  let swRegistration = null;

  // Service Worker kaydÄ± ve token alma iÅŸlemi
  navigator.serviceWorker.register('/firebase-messaging-sw.js')
    .then((registration) => {
      console.log("âœ… Service worker baÅŸarÄ±yla kayÄ±t edildi:", registration);
      swRegistration = registration;
      return Notification.requestPermission();
    })
    .then((permission) => {
      if (permission === "granted") {
        return messaging.getToken({
          vapidKey: 'BG2S16yckxN-v-uSckaUR0nnGLYQzwq4xgQO9O4HV2ojB4yEpchAtzEVy1hXJJCohqc4n7xwM2ELKeEAKpK6aR0',
          serviceWorkerRegistration: swRegistration
        });
      } else {
        throw new Error("Bildirim izni verilmedi");
      }
    })
    .then((currentToken) => {
      if (currentToken) {
        console.log("ðŸŽ¯ Token alÄ±ndÄ±:", currentToken);

        // Backend'e token gÃ¶nder
        fetch("/tokken_kaydetme/", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "X-CSRFToken": getCookie("csrftoken")
          },
          body: JSON.stringify({
            token: currentToken
          })
        })
        .then(response => response.json())
        .then(data => console.log("âœ… Token kaydÄ± tamam:", data))
        .catch(error => console.error("âŒ Backend hatasÄ±:", error));
      } else {
        console.warn("âš ï¸ Token alÄ±namadÄ±");
      }
    })
    .catch((err) => {
      console.error("âŒ Service worker veya token hatasÄ±:", err);
    });

  // Ã–n planda gelen mesajlarÄ± dinle
  messaging.onMessage((payload) => {
    console.log("ðŸ”” Ã–n planda gelen bildirim:", payload);
    // Burada toast veya modal ile gÃ¶sterim yapabilirsin
  });
</script>



</body>
</html>