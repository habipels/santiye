{% extends "homebase.html" %}
{% load i18n %}
{% load custom_tags  %}
{% load static %}
{% block sidebar %}


{%  bloglari_rapora_yansitma santiye.proje_santiye_Ait as blog %}
{% bloglar_daireleri_kalemleri_fiziksel_bilgileri santiye.id blog.k as fiziksel_ilerleme  %}
{% bloglar_daireleri_kalemleri_finansal_bilgileri santiye.id blog.k as finansal_ilerleme  %}
{% bloglar_daireleri_kalemleri_fiziksel_bilgileri_toplama_gonderme santiye.id blog.k as tablo  %}
    {% get_son_bir_hafta_icinde_degisenler santiye.id  as gun_kalem_sayilari  %}
     {% get_son_bir_yil_icinde_degisenler santiye.id  as ay_kalem_sayilari  %}
    <main>


        <div class="page-header">
            <div class="page-info">
                <div class="page-title">
                    <a href="#"><i class="icon icon-arrow-circle-left"></i></a>
                   {% trans 'Rapor' %} 
                </div>
                <ul class="page-breadcrumb">
                    <li><a href="#">{% trans 'Dashboard' %} </a></li>
                    <li><a href="#">{% trans 'Şantiye Yönetimi' %} </a></li>
                    <li><a href="#">{% trans 'Rapor' %} </a></li>
                </ul>
            </div>
        </div>


        <div class="report-charts">

            <div class="report-card">
                <div class="report-header">
                    <div class="report-title">{% trans 'İlerleme' %} </div>
                    <div class="report-stats-info">
                        <span><i class="icon icon-purple-circle"></i>{% trans 'Fiziksel' %}  </span>
                        <span><i class="icon icon-yellow-circle"></i>{% trans 'Finansal' %}  </span>
                    </div>
                </div>

                <div class="report-body">
                    <div id="ilerleme-chart"></div>

                    <script>
                        var options = {
                            series: [{
                                name: "{% trans 'Finansal' %} ",
                                data: {{gun_kalem_sayilari.degerler | safe}},
                            }, {
                                name: "{% trans 'Fiziksel' %} ",
                                data: {{gun_kalem_sayilari.degerler | safe}}
                            },],
                            chart: {
                                type: 'bar',
                                height: 350,
                                stacked: true,
                                toolbar: {
                                    show: false
                                },
                                zoom: {
                                    enabled: false
                                }
                            },
                            colors: ['#F9B035', '#6149CD'],
                            responsive: [{
                                breakpoint: 480,
                                options: {
                                    legend: {
                                        position: 'bottom',
                                        offsetX: -10,
                                        offsetY: 0
                                    }
                                }
                            }],
                            plotOptions: {
                                bar: {
                                    horizontal: false,
                                    borderRadius: 10,
                                    borderRadiusApplication: 'end', // 'around', 'end'
                                    borderRadiusWhenStacked: 'last', // 'all', 'last'
                                    dataLabels: {
                                        total: {
                                            enabled: true,
                                            style: {
                                                fontSize: '13px',
                                                fontWeight: 900
                                            }
                                        }
                                    }
                                },
                            },
                            xaxis: {
                                type: 'text',
                                categories: {{gun_kalem_sayilari.gunler | safe}},
                            },
                            legend: {
                                show: false
                            },
                            fill: {
                                opacity: 1
                            }
                        };

                        var chart = new ApexCharts(document.querySelector("#ilerleme-chart"), options);
                        chart.render();
                    </script>
                </div>
            </div>

            <div class="report-card">
                <div class="report-header">
                    <div class="report-title">{% trans 'İlerleme Tablosu' %} </div>
                    <div class="report-stats-info">
                        <span><i class="icon icon-purple-circle"></i>{% trans 'Fiziksel' %}  </span>
                        <span><i class="icon icon-yellow-circle"></i> {% trans 'Finansal' %} </span>
                    </div>
                </div>
                <div class="report-body">

                    <div id="ilerleme-tablosu-chart"></div>

                    <script>
                        var options = {
                            series: [{
                                name: "{% trans 'Finansal' %} ",
                                data: {{ay_kalem_sayilari.degerler |safe}}
                            }, {
                                name:"{% trans 'Fiziksel' %} " ,
                                data:  {{ay_kalem_sayilari.degerler |safe}}
                            }],
                            chart: {
                                height: 350,
                                type: 'area',
                                zoom: {
                                    enabled: false
                                }
                            },
                            dataLabels: {
                                enabled: false
                            },
                            stroke: {
                                curve: 'smooth'
                            },
                            xaxis: {
                                type: 'category',
                                categories: {{ay_kalem_sayilari.aylar |safe}}
                            },
                            legend: {
                                show: false
                            },
                            colors: ['#F9B035', '#6149CD'],
                            tooltip: {
                                x: {
                                    format: 'MMM'
                                }
                            }
                        };

                        var chart = new ApexCharts(document.querySelector("#ilerleme-tablosu-chart"), options);
                        chart.render();
                    </script>

                </div>
            </div>

        </div>


        <div class="report-card">
            <div class="report-header">
                <div class="report-details">
                    <div class="report-title"><i class="icon icon-yellow-circle"></i> {{santiye.proje_santiye_Ait.proje_tipi.Proje_tipi_adi}}</div>
                    <div class="report-infos">
                        <div class="report-info">{% trans 'Proje Adı:' %}  <b>{{santiye.proje_santiye_Ait.proje_adi}}</b></div>
                        <div class="report-info">{% trans 'Yapı Adı:' %} <b>{{santiye.blog_adi}}</b></div>
                    </div>
                </div>
            </div>

            <div class="report-building-body">
                <div class="report-bb-preview">
                    <img src="{% static 'go/content/images/bina.png' %}" alt="bina">
                </div>
                <div class="report-bb-chart">
                    <div id="report-bb-chart"></div>

                    <div class="report-bb-stats">
                        <div class="report-bb-stat">
                            <div class="report-bb-stat-title"><i class="icon icon-green-circle"></i>{% trans 'Tamamlanan' %} </div>
                            <div class="report-bb-stat-value">%{{fiziksel_ilerleme |safe }}</div>
                        </div>
                        <div class="report-bb-stat">
                            <div class="report-bb-stat-title"><i class="icon icon-white-circle"></i>{% trans 'Devam Eden' %} </div>
                            <div class="report-bb-stat-value">%{% basit_cikarma 100 fiziksel_ilerleme  %}</div>
                        </div>
                        <div class="report-bb-stat">
                            <div class="report-bb-stat-title"><i class="icon icon-red-circle"></i> Duran</div>
                            <div class="report-bb-stat-value">%1</div>
                        </div>
                    </div>

                    <script>
                        var options = {
                            series: [{{fiziksel_ilerleme |safe }}, {% basit_cikarma 100 fiziksel_ilerleme  %}, 1],
                            chart: {
                                height: 500,
                                type: 'radialBar',
                            },
                            plotOptions: {
                                radialBar: {
                                    dataLabels: {
                                        name: {
                                            fontSize: '22px',
                                        },
                                        value: {
                                            fontSize: '16px',
                                        },
                                        total: {
                                            show: true,
                                            label: 'Toplam',
                                            formatter: function (w) {
                                                return "%100"
                                            }
                                        }
                                    },

                                },
                            },
                            labels: ['Tamamlanan', 'Devam Eden', 'Duran'],
                            colors: ['#00A76F', '#DCDCDE', '#FF5630']
                        };

                        var chart = new ApexCharts(document.querySelector("#report-bb-chart"), options);
                        chart.render();
                    </script>
                </div>
            </div>
        </div>


        <div class="report-card">
            <div class="report-header">
                <div class="report-title">{% trans 'İmalat Kalemleri' %}</div>
            </div>
            <div class="report-body">
                <div class="imalat-kalemleri">
                {% for i in tablo %}
                
                
                    <div class="imalat-kalemi">
                        <div class="imalat-kalemi-check">
                            <input type="checkbox" id="imalat-kalemi-check-1" checked>
                        </div>
                        <div class="imalat-kalemi-progress">
                            <div class="imalat-kalemi-progress-details">
                                <div class="imalat-kalemi-progress-title">{{i.isim}}</div>
                                <div class="imalat-kalemi-progress-info">
                                    <span><i class="icon icon-green-accent-circle"></i>{% trans 'Fiziksel' %}  %{{i.ilerleme1}}</span>
                                    <span><i class="icon icon-green-circle"></i>{% trans 'Finansal' %}  %{{i.ilerleme2}}</span>
                                </div>
                            </div>
                            <div class="imalat-kalemi-progress-bar">
                                <div class="ik-progress-bar-fiziksel" style="--percentage: {{i.ilerleme1}}%"></div>
                                <div class="ik-progress-bar-finansal" style="--percentage: {{i.ilerleme2}}%"></div>
                            </div>
                        </div>
                    </div>

                 {% endfor %}
                </div>
            </div>
        </div>



    </main>

{% endblock sidebar %}

