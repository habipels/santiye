<main>

    <div class="quick-actions">
        <div class="quick-actions-header">
            <div class="quick-actions-title">{% trans 'Hızlı Menü' %}</div>
            <div class="quick-actions-right">
                <button class="quick-actions-add" onclick="showHiddenActions()">
                    <i class="icon icon-add"></i> {% trans 'Gizli Öğeler' %}
                </button>
                <div class="quick-actions-toggle">
                    <i class="icon icon-arrow-circle-up"></i>
                    <i class="icon icon-arrow-circle-down"></i>
                </div>
            </div>
        </div>
        <div class="quick-actions-body close">
            <div class="quick-actions-inner">
                <div class="quick-actions-grid" id="quick-actions-grid">
                    <a href="/{{dil}}{% url 'main:santiye_kalem_ve_blog' %}" class="quick-action" data-id="1" oncontextmenu="hideQuickLink(event, this)"><i
                            class="icon icon-document"></i> {% trans 'Raporlar' %}</a>
                    <a href="/{{dil}}{% url 'main:santiye_kalem_ve_blog'  %}" class="quick-action" data-id="2" oncontextmenu="hideQuickLink(event, this)"><i
                            class="icon icon-ilerleme-takibi"></i>{% trans 'İlerleme Takibi' %} </a>
                    <a href="/{{dil}}{% url 'accounting:giderler_ozeti' %}" class="quick-action" data-id="3" oncontextmenu="hideQuickLink(event, this)"><i
                            class="icon icon-giderler"></i> {% trans 'Giderler' %}</a>
                    <a href="/{{dil}}{% url 'accounting:gelirler_ozeti' %}" class="quick-action" data-id="4" oncontextmenu="hideQuickLink(event, this)"><i
                            class="icon icon-gelirler"></i>{% trans 'Gelirler' %} </a>
                    <a href="/{{dil}}{% url 'accounting:giderler_sayfasi_borc'  %}" class="quick-action" data-id="5" oncontextmenu="hideQuickLink(event, this)"><i
                            class="icon icon-muhasebe"></i>{% trans 'Borçlar' %} </a>
                    <a href="/{{dil}}{% url 'users:personeller_puantaj_sayfasi'  %}" class="quick-action" data-id="6" oncontextmenu="hideQuickLink(event, this)"><i
                            class="icon icon-puantaj-girisi"></i>{% trans 'Puantaj Girişi' %}</a>
                    <a href="/{{dil}}{% url 'accounting:satin_alma_talabi' %}" class="quick-action" data-id="7" oncontextmenu="hideQuickLink(event, this)"><i
                            class="icon icon-satin-alma"></i>{% trans 'Satın Alma' %}</a>
                    <a href="/{{dil}}{% url 'users:personeller_sayfasi'  %}" class="quick-action" data-id="8" oncontextmenu="hideQuickLink(event, this)"><i
                            class="icon icon-yeni-personel"></i>{% trans 'Personel Ekle' %} </a>
                    <a href="/{{dil}}{% url 'users:kullanicilarim'  %}" class="quick-action" data-id="9" oncontextmenu="hideQuickLink(event, this)"><i
                            class="icon icon-yeni-kullanici"></i> {% trans 'Kullanıcı Ekle' %}</a>
                    <a href="/{{dil}}{% url 'main:depolama_sistemim' %}" class="quick-action" data-id="10" oncontextmenu="hideQuickLink(event, this)"><i
                            class="icon icon-dosya-yoneticisi"></i>{% trans 'Dosya Yöneticisi' %} </a>
                    <a href="/{{dil}}{% url 'main:taseron_sayfasi'  %}" class="quick-action" data-id="11" oncontextmenu="hideQuickLink(event, this)"><i
                            class="icon icon-taseronlar"></i> {% trans 'Taşeronlar' %}</a>
                    <a href="/{{dil}}{% url 'main:sozlesmler_sayfasi'  %}"  class="quick-action" data-id="12" oncontextmenu="hideQuickLink(event, this)"><i
                            class="icon icon-sozlesmeler"></i> {% trans 'Sözleşmeler' %}</a>
                    <a href="/{{dil}}{% url 'main:hakedis_sayfasi'  %}" class="quick-action" data-id="13" oncontextmenu="hideQuickLink(event, this)"><i
                            class="icon icon-hakedisler"></i> {% trans 'Hakedişler' %}</a>
                    <a href="/{{dil}}{% url 'main:yapilacaklar'  %}" class="quick-action" data-id="14" oncontextmenu="hideQuickLink(event, this)"><i
                            class="icon icon-gorevler"></i> {% trans 'İş Emirleri' %}</a>
                    <a href="/{{dil}}{% url 'accounting:kasa'  %}" class="quick-action" data-id="15" oncontextmenu="hideQuickLink(event, this)"><i
                            class="icon icon-kasa"></i> {% trans 'Kasa' %}</a>
                    <a href="/{{dil}}{% url 'accounting:cari'  %}" class="quick-action" data-id="16" oncontextmenu="hideQuickLink(event, this)"><i
                            class="icon icon-users"></i> {% trans 'Cari Hesapları' %}</a>
                </div>
            </div>
        </div>
    </div>


    <div class="quick-action-modal " id="hiddenLinksModal">
        <div class="quick-action-modal-content">
            <div class="quick-action-modal-header">
                <span>{% trans 'Gizli Öğeler' %}</span>
                <button onclick="hideHiddenActions()"><i class="icon icon-close"></i></button>
            </div>
            <div class="quick-actions-grid modal-body">
            </div>
        </div>
    </div>

    <script>

        const hiddenLinksModalBody = document.querySelector('#hiddenLinksModal .modal-body');
        document.addEventListener('DOMContentLoaded', function () {
            const quickLinks = document.getElementById('quick-actions-grid');
            const hiddenLinksModalBody = document.querySelector('#hiddenLinksModal .modal-body');

            // Hızlı linkleri sürükle-bırak düzenleme
            new Sortable(quickLinks, {
                animation: 150,
                handle: '.quick-action',
                onEnd: function (evt) {
                    const items = Array.from(quickLinks.children);
                    const order = items.map(item => item.dataset.id);
                    sessionStorage.setItem('quickLinksOrder', JSON.stringify(order));
                }
            });


            // Gizli linkleri modalda geri getirme
            hiddenLinksModalBody.addEventListener('click', function (event) {
                const link = event.target.closest('.hidden-link');
                if (link) {
                    const id = link.dataset.id;
                    const hiddenItem = document.querySelector(`[data-id="${id}"]`);
                    if (hiddenItem) {
                        hiddenItem.style.display = "flex"; // Linki geri görünür yap
                        quickLinks.appendChild(hiddenItem); // Sayfaya geri ekle
                        link.remove(); // Modaldan kaldır
                        saveHiddenLinks(); // Gizli linklerin durumunu kaydet
                    }
                }
            });

            // Oturum açıldığında kullanıcı düzenini yükle
            const savedQuickLinksOrder = JSON.parse(sessionStorage.getItem('quickLinksOrder'));
            if (savedQuickLinksOrder) {
                savedQuickLinksOrder.forEach(id => {
                    const item = quickLinks.querySelector(`[data-id='${id}']`);
                    if (item) {
                        quickLinks.appendChild(item);
                    }
                });
            }

            // Gizli linklerin durumunu kaydet
            function saveHiddenLinks() {
                const hiddenLinks = Array.from(hiddenLinksModalBody.querySelectorAll('.hidden-link')).map(link => link.dataset.id);
                sessionStorage.setItem('hiddenLinks', JSON.stringify(hiddenLinks));
            }

            // Gizli linkleri yükleme
            function loadHiddenLinks() {
                const hiddenLinks = JSON.parse(sessionStorage.getItem('hiddenLinks'));
                if (hiddenLinks) {
                    hiddenLinks.forEach(id => {
                        const item = quickLinks.querySelector(`[data-id='${id}']`);
                        if (item) {
                            item.style.display = "none"; // Linki gizle
                            const hiddenLink = document.createElement('div');
                            hiddenLink.className = 'hidden-link';
                            hiddenLink.dataset.id = id;
                            hiddenLink.innerHTML = item.innerHTML;
                            hiddenLinksModalBody.appendChild(hiddenLink);
                        }
                    });
                }
            }

            loadHiddenLinks(); // Gizli linkleri sayfa yüklendiğinde çağır
        });

        // Gizli linklerin durumunu kaydet
        function saveHiddenLinks() {
            const hiddenLinks = Array.from(hiddenLinksModalBody.querySelectorAll('.hidden-link')).map(link => link.dataset.id);
            sessionStorage.setItem('hiddenLinks', JSON.stringify(hiddenLinks));
        }

        // Hızlı linki gizleme
        function hideQuickLink(event, element) {
            event.preventDefault();
            const id = element.dataset.id;
            element.style.display = "none"; // Sayfadan gizle
            const hiddenLink = document.createElement('div');
            hiddenLink.className = 'hidden-link';
            hiddenLink.dataset.id = id;
            hiddenLink.innerHTML = element.innerHTML;
            document.querySelector('#hiddenLinksModal .modal-body').appendChild(hiddenLink);
            saveHiddenLinks(); // Gizli linklerin durumunu kaydet
        }

        function showHiddenActions() {
            $(".quick-action-modal").css("display", "flex").hide().fadeIn();
        }

        function hideHiddenActions() {
            $(".quick-action-modal").fadeOut();
        }

        let quickActionModal = document.querySelector(".quick-action-modal");
        $(".quick-action-modal").on("click", function (e) {
            if (e.target == quickActionModal) {
                hideHiddenActions();
            }
        })

        let quickActionsToggle = document.querySelector(".quick-actions-toggle");
        let quickActionsBody = document.querySelector(".quick-actions-body");

        quickActionsToggle.addEventListener("click", function () {
            quickActionsBody.classList.toggle("open");
        });







    </script>



    <div class="main-cards">
        <div class="profile-card">
            <div class="profile-avatar-dash">
            {% if hash_bilgi.image %}
                    <img src="{{hash_bilgi.image.url}}" style="max-width: 80px; max-height: 80px;" alt="Profile">

                    {% else %}
                    <img src="{% static 'go/images/profile.png' %}" alt="Profile">
                    {% endif %}
                
            </div>
            <div class="profile-info">
                <div class="profile-title">{{hash_bilgi.last_name}} <span> {% if hash_bilgi.gorevi %}
                    {{hash_bilgi.gorevi}}
                {% else %}
                {% endif %} </span></div>
                <div class="profile-date"><i class="icon icon-calendar"></i> 

<span id="day-name"> </span><span id="fds">-</span>
<span id="full-date"></span>
</div>
                
            </div>
        </div>
        {% if request.user.kullanicilar_db %}
{% kulanici_yetkileri_kullandirt request.user request.user.kullanicilar_db as yetki %}
{% if yetki.gelir_ozeti_gorme %}
       <div class="stats-card">
            <div class="stats-title">{% trans 'GELİR' %}</div>
            {% if request.user.kullanicilar_db %}
            {% gelirler_tutari request.user.kullanicilar_db as gelir_bilgisi_cek %}
            {% else %}
            {% gelirler_tutari hash_bilgi as gelir_bilgisi_cek %}
            {% endif %}
            <div class="stats-content">
                <div class="stats-value"> $ {{gelir_bilgisi_cek.tutar}}</div>
                <div class="stats-rease">

                    {% if request.user.kullanicilar_db %}
                    {% gelir_yuzde_farki request.user.kullanicilar_db  as gelirhaftafarki %}
                    {% else %}
                    {% gelir_yuzde_farki request.user as gelirhaftafarki %}
                    {% endif %}
                    {% if request.user.kullanicilar_db %}
                    {% son_dort_ay_tutar request.user.kullanicilar_db  as aylik_gelir %}
                    {% else %}
                    {% son_dort_ay_tutar request.user as aylik_gelir %}
                    {% endif %}
                    {% if gelirhaftafarki.arti  %}
                <div class="stats-rease-icon"><i class="icon icon-increment"></i></div>
                {% blocktrans with fark=gelirhaftafarki.fark %}
                    <b>{{ fark }}%</b> haftalık değişim
                {% endblocktrans %}
            </div>
            {% else %}
                <div class="stats-rease-icon"><i class="icon icon-decrement"></i></div>
                {% blocktrans with fark=gelirhaftafarki.fark %}
                    <b>{{ fark }}%</b> haftalık değişim
                {% endblocktrans %}
            </div>
            {% endif %}

                    
            </div>
            <div class="stats-img">


                <div id="stats-gelir"></div>

                <script>
                    var options = {
                        series: [{
                            name: "{% trans 'Gelir' %}",
                            data: {{aylik_gelir.tutarlar | safe}}
                        }],
                        chart: {
                            width: 120,
                            height: 120,
                            type: 'line',
                            toolbar: {
                                show: false
                            },
                            zoom: {
                                enabled: false
                            },
                        },
                        dataLabels: {
                            enabled: false
                        },
                        stroke: {
                            curve: 'smooth',
                            colors: ['#22B076']
                        },
                        xaxis: {
                            labels: {
                                show: false
                            },
                            axisBorder: {
                                show: false
                            },
                            axisTicks: {
                                show: false
                            },
                            tickAmount: 0,
                            categories: {{aylik_gelir.aylar | safe}}
                        },
                        yaxis: {
                            labels: {
                                show: false
                            },
                            axisBorder: {
                                show: false
                            },
                            axisTicks: {
                                show: false
                            },
                            tickAmount: 0
                        },
                        grid: {
                            show: false
                        }
                    };


                    var chart = new ApexCharts(document.querySelector("#stats-gelir"), options);
                    chart.render();


                </script>




            </div>
        </div>                                     
                                                                                                    
{% endif %}
{% if yetki.gider_ozeti_gorme %}  
<div class="stats-card">
            <div class="stats-title">{% trans 'GİDER' %}</div>
            {% if request.user.kullanicilar_db %}
            {% giderler_tutari request.user.kullanicilar_db  as gider_bilgisicekeme %}
            {% else %}
            {% giderler_tutari request.user  as gider_bilgisicekeme %}
            {% endif %}
            <div class="stats-content">
                <div class="stats-value">$ {{gider_bilgisicekeme.genel_odeme2}}</div>
                <div class="stats-rease">
                {% if request.user.kullanicilar_db %}
                    {% gider_yuzde_farki request.user.kullanicilar_db  as gelirhaftafarki %}
                    {% else %}
                    {% gider_yuzde_farki request.user as gelirhaftafarki %}
                    {% endif %}
                    {% if request.user.kullanicilar_db %}
                    {% son_dort_ay_tutar_gider request.user.kullanicilar_db  as aylik_gelir %}
                    {% else %}
                    {% son_dort_ay_tutar_gider request.user as aylik_gelir %}
                    {% endif %}
                    {% if gelirhaftafarki.arti  %}
                <div class="stats-rease-icon"><i class="icon icon-increment"></i></div>
                {% blocktrans with fark=gelirhaftafarki.fark %}
                    <b>{{ fark }}%</b> haftalık değişim
                {% endblocktrans %}
            </div>
            {% else %}
                <div class="stats-rease-icon"><i class="icon icon-decrement"></i></div>
                {% blocktrans with fark=gelirhaftafarki.fark %}
                    <b>{{ fark }}%</b> haftalık değişim
                {% endblocktrans %}
            </div>
            {% endif %}
                    
            </div>
            <div class="stats-img">

                <div id="stats-gider"></div>

                <script>
                    var options = {
                        series: [{
                            name: "{% trans 'Gider' %}",
                            data: {{aylik_gelir.tutarlar | safe}}
                        }],
                        chart: {
                            width: 120,
                            height: 120,
                            type: 'line',
                            toolbar: {
                                show: false
                            },
                            zoom: {
                                enabled: false
                            },
                        },
                        dataLabels: {
                            enabled: false
                        },
                        stroke: {
                            curve: 'smooth',
                            colors: ['#26CFE3']
                        },
                        xaxis: {
                            labels: {
                                show: false
                            },
                            axisBorder: {
                                show: false
                            },
                            axisTicks: {
                                show: false
                            },
                            tickAmount: 0,
                            categories: {{aylik_gelir.aylar | safe}}
                        },
                        yaxis: {
                            labels: {
                                show: false
                            },
                            axisBorder: {
                                show: false
                            },
                            axisTicks: {
                                show: false
                            },
                            tickAmount: 0
                        },
                        grid: {
                            show: false
                        }
                    };


                    var chart = new ApexCharts(document.querySelector("#stats-gider"), options);
                    chart.render();


                </script>


            </div>
        </div>                                                      
{% endif %}
{% if yetki.hesap_ekstra_gorme %}
   <div class="stats-card">
            <div class="stats-title">{% trans 'BORÇ' %}</div>
            {% basit_cikarma  gelir_bilgisi_cek.tutar gelir_bilgisi_cek.genel_odeme as gelir_islem_sonucu  %}
                                                {% basit_cikarma  gider_bilgisicekeme.tutar gider_bilgisicekeme.genel_odeme as gider_islem_sonucu  %}
                                                {% basit_cikarma  gelir_islem_sonucu gider_islem_sonucu as sonuc_Bilgisi  %}
            <div class="stats-content">
                <div class="stats-value">${% mutlak_deger  sonuc_Bilgisi %}</div>
                <div class="stats-rease">
                    {% if request.user.kullanicilar_db %}
                    {% borc_yuzde_farki request.user.kullanicilar_db  as gelirhaftafarki %}
                    {% else %}
                    {% borc_yuzde_farki request.user as gelirhaftafarki %}
                    {% endif %}
                    {% if request.user.kullanicilar_db %}
                    {% borc_son_dort_ay_tutar request.user.kullanicilar_db  as aylik_gelir %}
                    {% else %}
                    {% borc_son_dort_ay_tutar request.user as aylik_gelir %}
                    {% endif %}
                    {% if gelirhaftafarki.arti  %}
                <div class="stats-rease-icon"><i class="icon icon-increment"></i></div>
                {% blocktrans with fark=gelirhaftafarki.fark %}
                    <b>{{ fark }}%</b> haftalık değişim
                {% endblocktrans %}
            </div>
            {% else %}
                <div class="stats-rease-icon"><i class="icon icon-decrement"></i></div>
                {% blocktrans with fark=gelirhaftafarki.fark %}
                    <b>{{ fark }}%</b> haftalık değişim
                {% endblocktrans %}
            </div>
            {% endif %}
            </div>
            <div class="stats-img">

                <div id="stats-borc"></div>

                <script>
                    var options = {
                        series: [{
                            name: "{% trans 'Borç' %}",
                            data: {{aylik_gelir.tutarlar | safe}}
                        }],
                        chart: {
                            width: 120,
                            height: 120,
                            type: 'line',
                            toolbar: {
                                show: false
                            },
                            zoom: {
                                enabled: false
                            },
                        },
                        dataLabels: {
                            enabled: false
                        },
                        stroke: {
                            curve: 'smooth',
                            colors: ['#26CFE3']
                        },
                        xaxis: {
                            labels: {
                                show: false
                            },
                            axisBorder: {
                                show: false
                            },
                            axisTicks: {
                                show: false
                            },
                            tickAmount: 0,
                            categories: {{aylik_gelir.aylar | safe}}
                        },
                        yaxis: {
                            labels: {
                                show: false
                            },
                            axisBorder: {
                                show: false
                            },
                            axisTicks: {
                                show: false
                            },
                            tickAmount: 0
                        },
                        grid: {
                            show: false
                        }
                    };


                    var chart = new ApexCharts(document.querySelector("#stats-borc"), options);
                    chart.render();


                </script>


            </div>
        </div>                                                                                                                                              
{% endif %}
{% if yetki.kasa_detay_izni %}
     <div class="register-card">
            <div class="register-card-title">
                {% if kasa %}
                    {{ kasa|length }}
                {% else %}
                    0
                {% endif %}
                <span>{% trans 'Kasa' %}</span>
            </div>
            <div class="register-card-registers">
            {% for i in kasa %}

                <div class="register-card-register"><i class="icon icon-register"></i> {{i.kasa_adi}} <span>$
                        {% kasa_toplam i %}</span></div>
            {% endfor %}
            </div>
        </div>                                                                                                                                             
{% endif %}
                                
{% else %}
    <div class="stats-card">
            <div class="stats-title">{% trans 'GELİR' %}</div>
            {% if request.user.kullanicilar_db %}
            {% gelirler_tutari request.user.kullanicilar_db as gelir_bilgisi_cek %}
            {% else %}
            {% gelirler_tutari request.user as gelir_bilgisi_cek %}
            {% endif %}
            <div class="stats-content">
                <div class="stats-value"> $ {{gelir_bilgisi_cek.tutar}}</div>
                <div class="stats-rease">

                    {% if request.user.kullanicilar_db %}
                    {% gelir_yuzde_farki request.user.kullanicilar_db  as gelirhaftafarki %}
                    {% else %}
                    {% gelir_yuzde_farki request.user as gelirhaftafarki %}
                    {% endif %}
                    {% if request.user.kullanicilar_db %}
                    {% son_dort_ay_tutar request.user.kullanicilar_db  as aylik_gelir %}
                    {% else %}
                    {% son_dort_ay_tutar request.user as aylik_gelir %}
                    {% endif %}
                    {% if gelirhaftafarki.arti  %}
                <div class="stats-rease-icon"><i class="icon icon-increment"></i></div>
                {% blocktrans with fark=gelirhaftafarki.fark %}
                    <b>{{ fark }}%</b> haftalık değişim
                {% endblocktrans %}
            </div>
            {% else %}
                <div class="stats-rease-icon"><i class="icon icon-decrement"></i></div>
                {% blocktrans with fark=gelirhaftafarki.fark %}
                    <b>{{ fark }}%</b> haftalık değişim
                {% endblocktrans %}
            </div>
            {% endif %}

                    
            </div>
            <div class="stats-img">


                <div id="stats-gelir"></div>

                <script>
                    var options = {
                        series: [{
                            name: "{% trans 'Gelir' %}",
                            data: {{aylik_gelir.tutarlar | safe}}
                        }],
                        chart: {
                            width: 120,
                            height: 120,
                            type: 'line',
                            toolbar: {
                                show: false
                            },
                            zoom: {
                                enabled: false
                            },
                        },
                        dataLabels: {
                            enabled: false
                        },
                        stroke: {
                            curve: 'smooth',
                            colors: ['#22B076']
                        },
                        xaxis: {
                            labels: {
                                show: false
                            },
                            axisBorder: {
                                show: false
                            },
                            axisTicks: {
                                show: false
                            },
                            tickAmount: 0,
                            categories: {{aylik_gelir.aylar | safe}}
                        },
                        yaxis: {
                            labels: {
                                show: false
                            },
                            axisBorder: {
                                show: false
                            },
                            axisTicks: {
                                show: false
                            },
                            tickAmount: 0
                        },
                        grid: {
                            show: false
                        }
                    };


                    var chart = new ApexCharts(document.querySelector("#stats-gelir"), options);
                    chart.render();


                </script>




            </div>
        </div>
        <div class="stats-card">
            <div class="stats-title">{% trans 'GİDER' %}</div>
            {% if request.user.kullanicilar_db %}
            {% giderler_tutari request.user.kullanicilar_db  as gider_bilgisicekeme %}
            {% else %}
            {% giderler_tutari request.user  as gider_bilgisicekeme %}
            {% endif %}
            <div class="stats-content">
                <div class="stats-value">$ {{gider_bilgisicekeme.genel_odeme2}}</div>
                <div class="stats-rease">
                {% if request.user.kullanicilar_db %}
                    {% gider_yuzde_farki request.user.kullanicilar_db  as gelirhaftafarki %}
                    {% else %}
                    {% gider_yuzde_farki request.user as gelirhaftafarki %}
                    {% endif %}
                    {% if request.user.kullanicilar_db %}
                    {% son_dort_ay_tutar_gider request.user.kullanicilar_db  as aylik_gelir %}
                    {% else %}
                    {% son_dort_ay_tutar_gider request.user as aylik_gelir %}
                    {% endif %}
                    {% if gelirhaftafarki.arti  %}
                <div class="stats-rease-icon"><i class="icon icon-increment"></i></div>
                {% blocktrans with fark=gelirhaftafarki.fark %}
                    <b>{{ fark }}%</b> haftalık değişim
                {% endblocktrans %}
            </div>
            {% else %}
                <div class="stats-rease-icon"><i class="icon icon-decrement"></i></div>
                {% blocktrans with fark=gelirhaftafarki.fark %}
                    <b>{{ fark }}%</b> haftalık değişim
                {% endblocktrans %}
            </div>
            {% endif %}
                    
            </div>
            <div class="stats-img">

                <div id="stats-gider"></div>

                <script>
                    var options = {
                        series: [{
                            name: "{% trans 'Gider' %}",
                            data: {{aylik_gelir.tutarlar | safe}}
                        }],
                        chart: {
                            width: 120,
                            height: 120,
                            type: 'line',
                            toolbar: {
                                show: false
                            },
                            zoom: {
                                enabled: false
                            },
                        },
                        dataLabels: {
                            enabled: false
                        },
                        stroke: {
                            curve: 'smooth',
                            colors: ['#26CFE3']
                        },
                        xaxis: {
                            labels: {
                                show: false
                            },
                            axisBorder: {
                                show: false
                            },
                            axisTicks: {
                                show: false
                            },
                            tickAmount: 0,
                            categories: {{aylik_gelir.aylar | safe}}
                        },
                        yaxis: {
                            labels: {
                                show: false
                            },
                            axisBorder: {
                                show: false
                            },
                            axisTicks: {
                                show: false
                            },
                            tickAmount: 0
                        },
                        grid: {
                            show: false
                        }
                    };


                    var chart = new ApexCharts(document.querySelector("#stats-gider"), options);
                    chart.render();


                </script>


            </div>
        </div>
        <div class="weather-card">
            <div class="weather-location">
            {{sehir}}
            <span id="day-names"></span>
            <span id="time-date"></span>
            </div>
            <div class="weather-content">
                <div class="weather-wind">
                    <span>{{weather_data.wind.speed}} km/s</span>
                    <div class="wind-direction" style="transform: rotate({{weather_data.wind.deg}}deg);">
                        <svg width="30" height="30" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2L15 8H9L12 2ZM12 22V8" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                </div>
                <div class="weather-temp">
                    <span>{{weather_data.main.temp |stringformat:'.f'}}°</span>
                    <img src="http://openweathermap.org/img/wn/{{icon}}@2x.png" alt="">
                </div>
            </div>
        </div>
        <div class="stats-card">
            <div class="stats-title">{% trans 'BORÇ' %}</div>
            {% basit_cikarma  gelir_bilgisi_cek.tutar gelir_bilgisi_cek.genel_odeme as gelir_islem_sonucu  %}
                                                {% basit_cikarma  gider_bilgisicekeme.tutar gider_bilgisicekeme.genel_odeme as gider_islem_sonucu  %}
                                                {% basit_cikarma  gelir_islem_sonucu gider_islem_sonucu as sonuc_Bilgisi  %}
            <div class="stats-content">
                <div class="stats-value">${% mutlak_deger  sonuc_Bilgisi %}</div>
                <div class="stats-rease">
                    {% if request.user.kullanicilar_db %}
                    {% borc_yuzde_farki request.user.kullanicilar_db  as gelirhaftafarki %}
                    {% else %}
                    {% borc_yuzde_farki request.user as gelirhaftafarki %}
                    {% endif %}
                    {% if request.user.kullanicilar_db %}
                    {% borc_son_dort_ay_tutar request.user.kullanicilar_db  as aylik_gelir %}
                    {% else %}
                    {% borc_son_dort_ay_tutar request.user as aylik_gelir %}
                    {% endif %}
                    {% if gelirhaftafarki.arti  %}
                <div class="stats-rease-icon"><i class="icon icon-increment"></i></div>
                {% blocktrans with fark=gelirhaftafarki.fark %}
                    <b>{{ fark }}%</b> haftalık değişim
                {% endblocktrans %}
            </div>
            {% else %}
                <div class="stats-rease-icon"><i class="icon icon-decrement"></i></div>
                {% blocktrans with fark=gelirhaftafarki.fark %}
                    <b>{{ fark }}%</b> haftalık değişim
                {% endblocktrans %}
            </div>
            {% endif %}
            </div>
            <div class="stats-img">

                <div id="stats-borc"></div>

                <script>
                    var options = {
                        series: [{
                            name: "{% trans 'Borç' %}",
                            data: {{aylik_gelir.tutarlar | safe}}
                        }],
                        chart: {
                            width: 120,
                            height: 120,
                            type: 'line',
                            toolbar: {
                                show: false
                            },
                            zoom: {
                                enabled: false
                            },
                        },
                        dataLabels: {
                            enabled: false
                        },
                        stroke: {
                            curve: 'smooth',
                            colors: ['#26CFE3']
                        },
                        xaxis: {
                            labels: {
                                show: false
                            },
                            axisBorder: {
                                show: false
                            },
                            axisTicks: {
                                show: false
                            },
                            tickAmount: 0,
                            categories: {{aylik_gelir.aylar | safe}}
                        },
                        yaxis: {
                            labels: {
                                show: false
                            },
                            axisBorder: {
                                show: false
                            },
                            axisTicks: {
                                show: false
                            },
                            tickAmount: 0
                        },
                        grid: {
                            show: false
                        }
                    };


                    var chart = new ApexCharts(document.querySelector("#stats-borc"), options);
                    chart.render();


                </script>


            </div>
        </div>
        <div class="register-card">
            <div class="register-card-title">
                {% if kasa %}
                    {{ kasa|length }}
                {% else %}
                    0
                {% endif %}
                <span>{% trans 'Kasa' %}</span>
            </div>
            <div class="register-card-registers">
            {% for i in kasa %}

                <div class="register-card-register"><i class="icon icon-register"></i> {{i.kasa_adi}} <span>$
                        {% kasa_toplam i %}</span></div>
            {% endfor %}
            </div>
        </div>                                     
{% endif %}
      
    </div>
    {% if request.user.kullanicilar_db %}
     {% ozellikler request.user.kullanicilar_db as ozellikleri %}      
    {% else %}
    {% ozellikler request.user as ozellikleri %}                                            
    {% endif %}
    {% if request.user.is_authenticated %}
    {% if request.user.kullanicilar_db %}
     {% kategori_bilgi_ver request.user.kullanicilar_db as bilgi_cagir %}    
    {% else %}
    {% kategori_bilgi_ver request.user as bilgi_cagir %}                                           
    {% endif %}
        
        {% endif %}
    {% if request.user.kullanicilar_db %}
{% kulanici_yetkileri_kullandirt request.user request.user.kullanicilar_db as yetki %}
{% if yetki.hesap_ekstra_gorme %}   
    <div class="large-cards">
        <div class="large-stats-card">
            <div class="stats-header">
                <div class="stats-title">{% trans 'Gelir - Gider Grafiği' %}</div>
                <div class="stats-period-dropdown">
                    <div class="stats-period">{% trans 'Aylık' %}</div>
                    <div class="stats-period-content">
                        <a href="#">{% trans 'Aylık' %}</a>
                        <a href="#">{% trans 'Yıllık' %}</a>
                    </div>
                </div>
            </div>
            <div id="gelirgider"></div>
        </div>
        <div class="large-stats-card expenses-by-category">
            <div class="stats-header">
                <div class="stats-title">{% trans 'Kategorilere Göre Giderler' %}</div>
            </div>
            <div id="expenses-by-category"></div>
            <div class="stats-footer">
                <div class="stats-footer-part">
                    <span>{% trans 'Kategori Sayısı' %}</span>
                    {{bilgi_cagir.isimleri | length}}
                </div>
                <div class="stats-footer-part">
                    <span>{% trans 'Toplam Gider' %}</span>
                    ${{bilgi_cagir.tutar}}
                </div>
            </div>
        </div>
    </div>
    
    <script>
        var options = {
            series: [{
                name: '{% trans "Gelir" %}',
                data: {{ozellikleri.gelir}}
            }, {
                name: '{% trans "Gider" %}',
                data: {{ozellikleri.gider}}
            }],
            chart: {
                height: 350,
                type: 'area',
                zoom: {
                    enabled: false
                }
            },
            dataLabels: {
                enabled: false
            },
            stroke: {
                curve: 'smooth'
            },
            xaxis: {
                type: 'category',
                categories: [ 
                    '{% trans "Ocak" %}', '{% trans "Şubat" %}', '{% trans "Mart" %}', '{% trans "Nisan" %}', '{% trans "Mayıs" %}', '{% trans "Haziran" %}',
                    '{% trans "Temmuz" %}', '{% trans "Ağustos" %}', '{% trans "Eylül" %}', '{% trans "Ekim" %}', '{% trans "Kasım" %}', '{% trans "Aralık" %}'
                ]
            },
            colors: ['#5FC396', '#FFAB00'],
            tooltip: {
                x: {
                    format: 'MMM'
                }
            }
        };

        var chart = new ApexCharts(document.querySelector("#gelirgider"), options);
        chart.render();




        var options = {
            series: {{bilgi_cagir.a}},
            labels: {{bilgi_cagir.isimleri |safe}},
            chart: {
                type: 'polarArea',
            },
            stroke: {
                colors: ['#fff']
            },
            fill: {
                opacity: 0.8
            },
        };

        var chart = new ApexCharts(document.querySelector("#expenses-by-category"), options);
        chart.render();



    </script>                                                                                                     
{% endif %}
                                
{% else %}
           <div class="large-cards">
        <div class="large-stats-card">
            <div class="stats-header">
                <div class="stats-title">{% trans 'Gelir - Gider Grafiği' %}</div>
                <div class="stats-period-dropdown">
                    <div class="stats-period">{% trans 'Aylık' %}</div>
                    <div class="stats-period-content">
                        <a href="#">{% trans 'Aylık' %}</a>
                        <a href="#">{% trans 'Yıllık' %}</a>
                    </div>
                </div>
            </div>
            <div id="gelirgider"></div>
        </div>
        <div class="large-stats-card expenses-by-category">
            <div class="stats-header">
                <div class="stats-title">{% trans 'Kategorilere Göre Giderler' %}</div>
            </div>
            <div id="expenses-by-category"></div>
            <div class="stats-footer">
                <div class="stats-footer-part">
                    <span>{% trans 'Kategori Sayısı' %}</span>
                    {{bilgi_cagir.isimleri | length}}
                </div>
                <div class="stats-footer-part">
                    <span>{% trans 'Toplam Gider' %}</span>
                    ${{bilgi_cagir.tutar}}
                </div>
            </div>
        </div>
    </div>
    
    <script>
        var options = {
            series: [{
                name: '{% trans "Gelir" %}',
                data: {{ozellikleri.gelir}}
            }, {
                name: '{% trans "Gider" %}',
                data: {{ozellikleri.gider}}
            }],
            chart: {
                height: 350,
                type: 'area',
                zoom: {
                    enabled: false
                }
            },
            dataLabels: {
                enabled: false
            },
            stroke: {
                curve: 'smooth'
            },
            xaxis: {
                type: 'category',
                categories: [ 
                    '{% trans "Ocak" %}', '{% trans "Şubat" %}', '{% trans "Mart" %}', '{% trans "Nisan" %}', '{% trans "Mayıs" %}', '{% trans "Haziran" %}',
                    '{% trans "Temmuz" %}', '{% trans "Ağustos" %}', '{% trans "Eylül" %}', '{% trans "Ekim" %}', '{% trans "Kasım" %}', '{% trans "Aralık" %}'
                ]
            },
            colors: ['#5FC396', '#FFAB00'],
            tooltip: {
                x: {
                    format: 'MMM'
                }
            }
        };

        var chart = new ApexCharts(document.querySelector("#gelirgider"), options);
        chart.render();




        var options = {
            series: {{bilgi_cagir.a}},
            labels: {{bilgi_cagir.isimleri |safe}},
            chart: {
                type: 'polarArea',
            },
            stroke: {
                colors: ['#fff']
            },
            fill: {
                opacity: 0.8
            },
        };

        var chart = new ApexCharts(document.querySelector("#expenses-by-category"), options);
        chart.render();



    </script>                                    
{% endif %}



    <div class="large-cards">
        {% if request.user.kullanicilar_db %}
{% kulanici_yetkileri_kullandirt request.user request.user.kullanicilar_db as yetki %}
{% if yetki.gelir_ozeti_gorme %}      
<div class="large-cards-main-row">
            <div class="large-stats-card table-card">
                <div class="stats-header">
                    <div class="stats-title">{% trans 'Faturalar' %}</div>
                    <div class="stats-period-dropdown">
                        <div class="stats-period">{% trans 'Aylık' %}</div>
                        <div class="stats-period-content">
                            <a href="#">{% trans 'Aylık' %}</a>
                            <a href="#">{% trans 'Yıllık' %}</a>
                        </div>
                    </div>
                </div>

                <div class="table-wrapper">
                    <table id="faturalar">
                        <thead>
                            <tr>
                                <th>{% trans 'Fatura No' %}</th>
                                <th>{% trans 'Ünvan' %}</th>
                                <th>{% trans 'aciklama' %}</th>
                                <th>{% trans 'Fatura Tarihi' %}</th>
                                <th>{% trans 'Fatura Tutarı' %}</th>
                                <th>{% trans 'Kalan Tutarı' %}</th>
                                <th>{% trans 'Durum' %}</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for i in  bilgi %}
                            <tr>
                                {% toplam_odenme_tutari i as odeme %}
                                {% toplam_tutar_cikarmai i as tutar %}
                                <td><h5 class="fs-13 my-1"><a  href="/{{dil}}{% url 'accounting:fatura_goster2' i.id %}"  class="faturano-link">{{i.fatura_no}}</a>
                                </h5></td>
                                <td>{{i.cari_bilgisi.cari_adi}}</td>
                                <td>{{i.aciklama}}</td>
                                <td>{{i.fatura_tarihi| date:'d.m.Y'}} <span class="time"></span></td>
                                <td> {% toplam_tutar_cikarmai i as fiyat %} $ {% fiyat_duzelt_html fiyat %}</td>
                                <td>
                                    {% kalan_tutuari i as fiyat %}$ {% fiyat_duzelt_html fiyat %}
                                </td>
                                {% if  odeme == tutar %}
                                <td><span class="status-success">{% trans "Ödendi" %}</span></td>
                                {% elif odeme > 0 %}
                                <td><span class="status-pending">{% trans "Beklemede" %}</span></td>
                                {% elif odeme == 0 %}
                                <td><span class="status-cancel">{% trans "Ödenmedi" %}</span></td>
                                {% endif %}
                                
                                </tr>
                                {% endfor %}
                        </tbody>
                    </table>
                </div>

                <div class="table-footer">
                    <a href="/{{dil}}{% url 'accounting:giderler_sayfasi'  %}">{% trans 'Tümünü Gör <i class="icon icon-chevron-right"></i>' %}</a>
                </div>

            </div>

            <div class="large-stats-card table-card">
                <div class="stats-header">
                    <div class="stats-title">{% trans 'Borç Faturaları' %}</div>
                    <div class="stats-period-dropdown">
                        <div class="stats-period">{% trans 'Aylık' %}</div>
                        <div class="stats-period-content">
                            <a href="#">{% trans 'Aylık' %}</a>
                            <a href="#">{% trans 'Yıllık' %}</a>
                        </div>
                    </div>
                </div>

                <div class="table-wrapper">
                    <table id="borc-faturalar">
                        <thead>
                            <tr>
                                <th>{% trans 'Fatura No' %}</th>
                                <th>{% trans 'Ünvan' %}</th>
                                <th>{% trans 'aciklama' %}</th>
                                <th>{% trans 'Fatura Tarihi' %}</th>
                                <th>{% trans 'Fatura Tutarı' %}</th>
                                <th>{% trans 'Kalan Tutarı' %}</th>
                                <th>{% trans 'Durum' %}</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for i in  gider  %}
                            <tr>
                                {% toplam_odenme_tutari i as odeme %}
                                {% toplam_tutar_cikarmai i as tutar %}
                                <td><h5 class="fs-13 my-1"><a  href="/{{dil}}{% url 'accounting:fatura_goster2' i.id %}"  class="faturano-link">{{i.fatura_no}}</a>
                                </h5></td>
                                <td>{{i.cari_bilgisi.cari_adi}}</td>
                                <td>{{i.aciklama}}</td>
                                <td>{{i.fatura_tarihi| date:'d.m.Y'}} <span class="time"></span></td>
                                <td>{% toplam_tutar_cikarmai i as fiyat %} ${% fiyat_duzelt_html fiyat %}</td>
                                <td>
                                    {% kalan_tutuari i as fiyat %} ${% fiyat_duzelt_html fiyat %}
                                </td>
                                {% if  odeme == tutar %}
                                <td><span class="status-success">{% trans "Ödendi" %}</span></td>
                                {% elif odeme > 0 %}
                                <td><span class="status-pending">{% trans "Beklemede" %}</span></td>
                                {% elif odeme == 0 %}
                                <td><span class="status-cancel">{% trans "Ödenmedi" %}</span></td>
                                {% endif %}
                                
                                </tr>
                                {% endfor %}

                        </tbody>
                    </table>
                </div>

                <div class="table-footer">
                <a href="/{{dil}}{% url 'accounting:giderler_sayfasi_borc'  %}">{% trans 'Tümünü Gör <i class="icon icon-chevron-right"></i>' %}</a>
                    
                </div>

            </div>

            <div class="large-stats-card table-card">
                <div class="stats-header">
                    <div class="stats-title">{% trans 'İş Emirleri' %}</div>
                    <div class="stats-period-dropdown">
                        <div class="stats-period">{% trans 'Tüm İş Emirleri' %}</div>
                        <div class="stats-period-content">
                            <a href="/{{dil}}{% url 'main:yapilacaklar' %}">{% trans 'Tüm İş Emirleri' %}</a>
                        </div>
                    </div>
                </div>

                <div class="table-wrapper">
                    <table id="gorevler">
                        <thead>
                            <tr>
                                <th>{% trans 'İş Emri Adı' %}</th>
                                <th>{% trans 'Açıklama' %}</th>
                                
                                <th>{% trans 'Bitiş Tarihi' %}</th>
                                <th>{% trans 'Öncelik' %}</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for i in son_gorevler %}
                            <tr>
                                <td>{{i.title}}</td>
                                <td>{{i.aciklama}}</td>
                            
                                <td>{{i.teslim_tarihi}}</td>
                                <td>
                                {% if i.oncelik_durumu == "High" %}
                                    <span class="status-danger">{{i.oncelik_durumu}}</span>
                                        {% elif i.oncelik_durumu == "Medium" %}
                                        
                                         <span class="status-warning">{{i.oncelik_durumu}}</span>
                                        {% elif i.oncelik_durumu == "Low" %}
                                        <span class="status-success">{{i.oncelik_durumu}}</span>
                                        {% endif %}</td>
                            </tr>
                            {% endfor %}
                            

                        </tbody>
                    </table>
                </div>


                <div class="table-footer">
                   <a href="/{{dil}}{% url 'main:yapilacaklar' %}">{% trans 'Tümünü Gör <i class="icon icon-chevron-right"></i>' %}</a> 
                </div>

            </div>
        </div>

        <script>
            let faturalar = new DataTable('#faturalar', {
                paging: false,
                searching: false,
                info: false,
                // responsive: true
            });

            let borcfaturalar = new DataTable('#borc-faturalar', {
                paging: false,
                searching: false,
                info: false,
                // responsive: true
            });

            let gorevler = new DataTable('#gorevler', {
                paging: false,
                searching: false,
                info: false,
                // responsive: true
            });
        </script>                                                                                                  
{% endif %}
                                
{% else %}
 <div class="large-cards-main-row">
            <div class="large-stats-card table-card">
                <div class="stats-header">
                    <div class="stats-title">{% trans 'Faturalar' %}</div>
                    <div class="stats-period-dropdown">
                        <div class="stats-period">{% trans 'Aylık' %}</div>
                        <div class="stats-period-content">
                            <a href="#">{% trans 'Aylık' %}</a>
                            <a href="#">{% trans 'Yıllık' %}</a>
                        </div>
                    </div>
                </div>

                <div class="table-wrapper">
                    <table id="faturalar">
                        <thead>
                            <tr>
                                <th>{% trans 'Fatura No' %}</th>
                                <th>{% trans 'Ünvan' %}</th>
                                <th>{% trans 'aciklama' %}</th>
                                <th>{% trans 'Fatura Tarihi' %}</th>
                                <th>{% trans 'Fatura Tutarı' %}</th>
                                <th>{% trans 'Kalan Tutarı' %}</th>
                                <th>{% trans 'Durum' %}</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for i in  bilgi %}
                            <tr>
                                {% toplam_odenme_tutari i as odeme %}
                                {% toplam_tutar_cikarmai i as tutar %}
                                <td><h5 class="fs-13 my-1"><a  href="/{{dil}}{% url 'accounting:fatura_goster2' i.id %}"  class="faturano-link">{{i.fatura_no}}</a>
                                </h5></td>
                                <td>{{i.cari_bilgisi.cari_adi}}</td>
                                <td>{{i.aciklama}}</td>
                                <td>{{i.fatura_tarihi| date:'d.m.Y'}} <span class="time"></span></td>
                                <td> {% toplam_tutar_cikarmai i as fiyat %} $ {% fiyat_duzelt_html fiyat %}</td>
                                <td>
                                    {% kalan_tutuari i as fiyat %}$ {% fiyat_duzelt_html fiyat %}
                                </td>
                                {% if  odeme == tutar %}
                                <td><span class="status-success">{% trans "Ödendi" %}</span></td>
                                {% elif odeme > 0 %}
                                <td><span class="status-pending">{% trans "Beklemede" %}</span></td>
                                {% elif odeme == 0 %}
                                <td><span class="status-cancel">{% trans "Ödenmedi" %}</span></td>
                                {% endif %}
                                
                                </tr>
                                {% endfor %}
                        </tbody>
                    </table>
                </div>

                <div class="table-footer">
                    <a href="/{{dil}}{% url 'accounting:giderler_sayfasi'  %}">{% trans 'Tümünü Gör <i class="icon icon-chevron-right"></i>' %}</a>
                </div>

            </div>

            <div class="large-stats-card table-card">
                <div class="stats-header">
                    <div class="stats-title">{% trans 'Borç Faturaları' %}</div>
                    <div class="stats-period-dropdown">
                        <div class="stats-period">{% trans 'Aylık' %}</div>
                        <div class="stats-period-content">
                            <a href="#">{% trans 'Aylık' %}</a>
                            <a href="#">{% trans 'Yıllık' %}</a>
                        </div>
                    </div>
                </div>

                <div class="table-wrapper">
                    <table id="borc-faturalar">
                        <thead>
                            <tr>
                                <th>{% trans 'Fatura No' %}</th>
                                <th>{% trans 'Ünvan' %}</th>
                                <th>{% trans 'aciklama' %}</th>
                                <th>{% trans 'Fatura Tarihi' %}</th>
                                <th>{% trans 'Fatura Tutarı' %}</th>
                                <th>{% trans 'Kalan Tutarı' %}</th>
                                <th>{% trans 'Durum' %}</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for i in  gider  %}
                            <tr>
                                {% toplam_odenme_tutari i as odeme %}
                                {% toplam_tutar_cikarmai i as tutar %}
                                <td><h5 class="fs-13 my-1"><a  href="/{{dil}}{% url 'accounting:fatura_goster2' i.id %}"  class="faturano-link">{{i.fatura_no}}</a>
                                </h5></td>
                                <td>{{i.cari_bilgisi.cari_adi}}</td>
                                <td>{{i.aciklama}}</td>
                                <td>{{i.fatura_tarihi| date:'d.m.Y'}} <span class="time"></span></td>
                                <td>{% toplam_tutar_cikarmai i as fiyat %} ${% fiyat_duzelt_html fiyat %}</td>
                                <td>
                                    {% kalan_tutuari i as fiyat %} ${% fiyat_duzelt_html fiyat %}
                                </td>
                                {% if  odeme == tutar %}
                                <td><span class="status-success">{% trans "Ödendi" %}</span></td>
                                {% elif odeme > 0 %}
                                <td><span class="status-pending">{% trans "Beklemede" %}</span></td>
                                {% elif odeme == 0 %}
                                <td><span class="status-cancel">{% trans "Ödenmedi" %}</span></td>
                                {% endif %}
                                
                                </tr>
                                {% endfor %}

                        </tbody>
                    </table>
                </div>

                <div class="table-footer">
                <a href="/{{dil}}{% url 'accounting:giderler_sayfasi_borc'  %}">{% trans 'Tümünü Gör <i class="icon icon-chevron-right"></i>' %}</a>
                    
                </div>

            </div>

            <div class="large-stats-card table-card">
                <div class="stats-header">
                    <div class="stats-title">{% trans 'İş Emirleri' %}</div>
                    <div class="stats-period-dropdown">
                        <div class="stats-period">{% trans 'Tüm İş Emirleri' %}</div>
                        <div class="stats-period-content">
                            <a href="/{{dil}}{% url 'main:yapilacaklar' %}">{% trans 'Tüm İş Emirleri' %}</a>
                        </div>
                    </div>
                </div>

                <div class="table-wrapper">
                    <table id="gorevler">
                        <thead>
                            <tr>
                                <th>{% trans 'Görev Adı' %}</th>
                                <th>{% trans 'Açıklama' %}</th>
                                
                                <th>{% trans 'Bitiş Tarihi' %}</th>
                                <th>{% trans 'Öncelik' %}</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for i in son_gorevler %}
                            <tr>
                                <td>{{i.title}}</td>
                                <td>{{i.aciklama}}</td>
                            
                                <td>{{i.teslim_tarihi}}</td>
                                <td>
                                {% if i.oncelik_durumu == "High" %}
                                    <span class="status-danger">{{i.oncelik_durumu}}</span>
                                        {% elif i.oncelik_durumu == "Medium" %}
                                        
                                         <span class="status-warning">{{i.oncelik_durumu}}</span>
                                        {% elif i.oncelik_durumu == "Low" %}
                                        <span class="status-success">{{i.oncelik_durumu}}</span>
                                        {% endif %}</td>
                            </tr>
                            {% endfor %}
                            

                        </tbody>
                    </table>
                </div>


                <div class="table-footer">
                   <a href="/{{dil}}{% url 'main:yapilacaklar' %}">{% trans 'Tümünü Gör <i class="icon icon-chevron-right"></i>' %}</a> 
                </div>

            </div>
        </div>

        <script>
            let faturalar = new DataTable('#faturalar', {
                paging: false,
                searching: false,
                info: false,
                // responsive: true
            });

            let borcfaturalar = new DataTable('#borc-faturalar', {
                paging: false,
                searching: false,
                info: false,
                // responsive: true
            });

            let gorevler = new DataTable('#gorevler', {
                paging: false,
                searching: false,
                info: false,
                // responsive: true
            });
        </script>                                      
{% endif %}
        



        <div class="large-cards-second-row">

         <div class="card">
                <div class="stats-header">
                <div class="isemri-title">{% trans 'Aktif İş Emirleri' %}</div>
                </div>
                <div class="card-body">
                    <div class="building-container">
                                                <div class="building" id="building">
                                                    <div class="face" id="face1"><div class="roof">Kuzey</div></div>
                                                    <div class="face" id="face2"><div class="roof">Doğu</div></div>
                                                    <div class="face" id="face3"><div class="roof">Güney</div></div>
                                                    <div class="face" id="face4"><div class="roof">Batı</div></div>
                                                </div>
                    
                                                <!-- Mouse yanında çıkan mini modal -->
                                                <div id="infoModal" class="info-modal">
                                                    <span class="close-btn" onclick="closeInfoModal()">×</span>
                                                    <p id="modalText"></p>
                                                    <button class="action-btn" onclick="goToTask()">İş Emrine Git</button>
                                                </div>
                    </div>
                </div>
                    <div class="card-footer">
                       <a href="/{{dil}}{% url 'main:yapilacaklar' %}" class="card-show-all"> {% trans 'Tümünü Gör <i class="icon icon-forward"></i>' %}</a>
                    </div>
            </div>
<!-- Eski 3d bina bloğu
            <div class="card">
                <div class="cardbuild">
                            <div class="stats-header">
                                <div class="stats-title">
                                    {% trans 'Aktif İş Emirleri' %}
                                </div>
                            </div>
                                <div class="cardbuild-body">
                                            <div class="building-container">
                                                <div class="building" id="building">
                                                    <div class="face" id="face1"><div class="roof">Kuzey</div></div>
                                                    <div class="face" id="face2"><div class="roof">Doğu</div></div>
                                                    <div class="face" id="face3"><div class="roof">Güney</div></div>
                                                    <div class="face" id="face4"><div class="roof">Batı</div></div>
                                                </div>
                                            </div>
                                                <div id="infoModal" class="info-modal">
                                                    <span class="close-btn" onclick="closeInfoModal()">×</span>
                                                    <p id="modalText"></p>
                                                    <button class="action-btn" onclick="goToTask()">İş Emrine Git</button>
                                                </div>
                                    </div>
                </div>
            </div>-->
                            {% if request.user.kullanicilar_db %}
{% kulanici_yetkileri_kullandirt request.user request.user.kullanicilar_db as yetki %}
{% if yetki.personeller_odeme_gorme %}  
<div class="card">
                <div class="card-header">
                    <div class="card-title">
                        {% if request.user.kullanicilar_db %}
                        {% dashboard_bilgisi request.user.kullanicilar_db as personelbilgi %}    
                        {% else %}
                        {% dashboard_bilgisi request.user as personelbilgi %}                                          
                        {% endif %}
                            
                            
                        {% trans 'Personeller' %}
                        <span>{% blocktrans with personel_sayisi=personelbilgi.personel_sayisi %}
                            Toplam {{ personel_sayisi }} personel
                        {% endblocktrans %}</span>
                    </div>
                    <a href="/{{dil}}{% url 'users:personeller_sayfasi' %}"><i class="icon icon-plus"></i></a>
                </div>
                
                <div class="card-body">
                {% for i in personelbilgi.personeller %}
                    <div class="employees">
                        <div class="employee">
                            <div class="employee-image"><img src="{{i.resim}}" alt=""></div>
                            <div class="employee-details">
                                {{i.isim_soyisim}}
                                <span>{{i.telefon_numarasi}}</span>
                            </div>
                            <div class="employee-stats">
                                <span>Ay / Çalışma Saati</span>
                                {{i.toplam_calisma_saati}}
                            </div>
                        </div>
                        
                    </div>
                     {% endfor %}
                    <div class="card-footer">
                       <a href="/{{dil}}{% url 'users:personeller_sayfasi' %}" class="card-show-all"> {% trans 'Tümünü Gör <i class="icon icon-forward"></i>' %}</a>
                    </div>
                </div>
               
            </div>                                                                                                      
{% endif %}
                                
{% else %}
    <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        {% if request.user.kullanicilar_db %}
                        {% dashboard_bilgisi request.user.kullanicilar_db as personelbilgi %}    
                        {% else %}
                        {% dashboard_bilgisi request.user as personelbilgi %}                                          
                        {% endif %}
                            
                            
                        {% trans 'Personeller' %}
                        <span>{% blocktrans with personel_sayisi=personelbilgi.personel_sayisi %}
                            Toplam {{ personel_sayisi }} personel
                        {% endblocktrans %}</span>
                    </div>
                    <a href="/{{dil}}{% url 'users:personeller_sayfasi' %}"><i class="icon icon-plus"></i></a>
                </div>
                
                <div class="card-body">
                {% for i in personelbilgi.personeller %}
                    <div class="employees">
                        <div class="employee">
                            <div class="employee-image"><img src="{{i.resim}}" alt=""></div>
                            <div class="employee-details">
                                {{i.isim_soyisim}}
                                <span>{{i.telefon_numarasi}}</span>
                            </div>
                            <div class="employee-stats">
                                <span>Ay / Çalışma Saati</span>
                                {{i.toplam_calisma_saati}}
                            </div>
                        </div>
                        
                    </div>
                     {% endfor %}
                    <div class="card-footer">
                       <a href="/{{dil}}{% url 'users:personeller_sayfasi' %}" class="card-show-all"> {% trans 'Tümünü Gör <i class="icon icon-forward"></i>' %}</a>
                    </div>
                </div>
               
            </div>                                    
{% endif %}
           {% if request.user.kullanicilar_db %}
{% kulanici_yetkileri_kullandirt request.user request.user.kullanicilar_db as yetki %}
{% if yetki.santiye_gorme %}   
<div class="info-card">
                <div class="info-card-image">
                    <img src="{% static 'go/images/info-card-1.png' %}" alt="Aktif Şantiye Sayısı">
                </div>
                <div class="info-card-content">
                {% blocktrans with aktif_santiye=personelbilgi.aktif_santiye %}
                        {{ aktif_santiye }} <span>Aktif Şantiye Sayısı</span>
                        {% endblocktrans %}
                
                    
                </div>
            </div>                                                                                                     
{% endif %}
                                
{% else %}
     <div class="info-card">
                <div class="info-card-image">
                    <img src="{% static 'go/images/info-card-1.png' %}" alt="Aktif Şantiye Sayısı">
                </div>
                <div class="info-card-content">
                {% blocktrans with aktif_santiye=personelbilgi.aktif_santiye %}
                        {{ aktif_santiye }} <span>Aktif Şantiye Sayısı</span>
                        {% endblocktrans %}
                
                    
                </div>
            </div>                                     
{% endif %}

     {% if request.user.kullanicilar_db %}
{% kulanici_yetkileri_kullandirt request.user request.user.kullanicilar_db as yetki %}
{% if yetki.personeller_gorme %} 
            <div class="info-card">
                <div class="info-card-image">
                    <img src="{% static 'go/images/info-card-2.png' %}" alt="Aktif Personel Sayısı">
                </div>
                <div class="info-card-content">
                {% blocktrans with personel_sayisi=personelbilgi.personel_sayisi %}
                        {{ personel_sayisi }} <span>Aktif Personel Sayısı</span>
                        {% endblocktrans %}
                   
                </div>
            </div>                                                                                                       
{% endif %}
                                
{% else %}
                   <div class="info-card">
                <div class="info-card-image">
                    <img src="{% static 'go/images/info-card-2.png' %}" alt="Aktif Personel Sayısı">
                </div>
                <div class="info-card-content">
                {% blocktrans with personel_sayisi=personelbilgi.personel_sayisi %}
                        {{ personel_sayisi }} <span>Aktif Personel Sayısı</span>
                        {% endblocktrans %}
                   
                </div>
            </div>                                    
{% endif %}    
{% if request.user.kullanicilar_db %}
{% kulanici_yetkileri_kullandirt request.user request.user.kullanicilar_db as yetki %}
{% if yetki.projeler_gorme %}  
<div class="info-card">
                <div class="info-card-image">
                    <img src="{% static 'go/images/info-card-3.png' %}" alt="Aktif Proje Sayısı">
                </div>
                <div class="info-card-content">
                {% blocktrans with aktif_proje=personelbilgi.aktif_proje %}
                        {{ aktif_proje }} <span>Aktif Proje Sayısı</span>
                        {% endblocktrans %}
                    
                </div>
            </div>                                                                                                      
{% endif %}
                                
{% else %}
    <div class="info-card">
                <div class="info-card-image">
                    <img src="{% static 'go/images/info-card-3.png' %}" alt="Aktif Proje Sayısı">
                </div>
                <div class="info-card-content">
                {% blocktrans with aktif_proje=personelbilgi.aktif_proje %}
                        {{ aktif_proje }} <span>Aktif Proje Sayısı</span>
                        {% endblocktrans %}
                    
                </div>
            </div>                                     
{% endif %}


          

        </div>

    </div>



</main>